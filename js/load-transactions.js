transaction_list = async () => {
    return    [
        {
            type: 'IN',
            value: 10234.50,
            source: 'Order #234',
            date: '2024-01-15'
        },
        {
            type: 'OUT',
            value: 4500.00,
            source: 'Cloud Expenses',
            date: '2024-02-05'
        },
        {
            type: 'IN',
            value: 33422.10,
            source: 'Contract #543',
            date: '2024-03-03'
        },
        {
            type: 'OUT',
            value: 9000.00,
            source: 'Office Rent',
            date: '2024-02-28'
        },
        {
            type: 'OUT',
            value: 1200.00,
            source: 'Utilities',
            date: '2024-03-18'
        },
        {
            type: 'IN',
            value: 18500.00,
            source: 'Order #567',
            date: '2024-03-22'
        },
        {
            type: 'OUT',
            value: 6000.00,
            source: 'Reimbursement',
            date: '2024-01-12'
        },
        {
            type: 'IN',
            value: 25800.00,
            source: 'Contract #890',
            date: '2024-04-09'
        },
        {
            type: 'OUT',
            value: 54000.00,
            source: 'Payroll',
            date: '2024-03-04'
        },
        {
            type: 'OUT',
            value: 2300.00,
            source: 'Cloud Expenses',
            date: '2024-04-21'
        },
        {
            type: 'IN',
            value: 15000.00,
            source: 'Order #678',
            date: '2024-02-15'
        },
        {
            type: 'OUT',
            value: 7800.00,
            source: 'Penalty For Delay',
            date: '2024-04-12'
        },
        {
            type: 'IN',
            value: 19500.50,
            source: 'Contract #345',
            date: '2024-05-03'
        },
        {
            type: 'OUT',
            value: 6700.00,
            source: 'Reimbursement',
            date: '2024-05-15'
        },
        {
            type: 'IN',
            value: 8200.75,
            source: 'Order #123',
            date: '2024-01-25'
        },
        {
            type: 'OUT',
            value: 1500.00,
            source: 'Office Utilities',
            date: '2024-03-01'
        },
        {
            type: 'IN',
            value: 23450.00,
            source: 'Contract #789',
            date: '2024-04-17'
        },
        {
            type: 'OUT',
            value: 9000.00,
            source: 'Employee Reimbursement',
            date: '2024-05-25'
        },
        {
            type: 'IN',
            value: 16700.00,
            source: 'Order #456',
            date: '2024-02-10'
        },
        {
            type: 'OUT',
            value: 5000.00,
            source: 'Cloud Expenses',
            date: '2024-06-03'
        },
        {
            type: 'IN',
            value: 32400.00,
            source: 'Contract #999',
            date: '2024-06-15'
        },
        {
            type: 'OUT',
            value: 3000.00,
            source: 'Office Rent',
            date: '2024-02-28'
        },
        {
            type: 'IN',
            value: 29800.00,
            source: 'Order #910',
            date: '2024-03-05'
        },
        {
            type: 'OUT',
            value: 5500.00,
            source: 'Cloud Expenses',
            date: '2024-03-19'
        },
        {
            type: 'IN',
            value: 19200.00,
            source: 'Contract #301',
            date: '2024-02-27'
        },
        {
            type: 'OUT',
            value: 7400.00,
            source: 'Penalty For Delay',
            date: '2024-06-10'
        },
        {
            type: 'IN',
            value: 17500.00,
            source: 'Order #764',
            date: '2024-04-29'
        },
        {
            type: 'OUT',
            value: 3200.00,
            source: 'Office Utilities',
            date: '2024-05-19'
        },
        {
            type: 'IN',
            value: 25600.00,
            source: 'Contract #412',
            date: '2024-07-01'
        },
        {
            type: 'OUT',
            value: 6000.00,
            source: 'Reimbursement',
            date: '2024-06-25'
        },
        {
            type: 'IN',
            value: 11200.00,
            source: 'Order #789',
            date: '2024-05-04'
        },
        {
            type: 'OUT',
            value: 24000.00,
            source: 'Office Rent',
            date: '2024-03-22'
        },
        {
            type: 'IN',
            value: 18200.00,
            source: 'Contract #235',
            date: '2024-08-14'
        },
        {
            type: 'OUT',
            value: 9500.00,
            source: 'Employee Reimbursement',
            date: '2024-07-13'
        },
        {
            type: 'IN',
            value: 14900.00,
            source: 'Order #650',
            date: '2024-09-11'
        },
        {
            type: 'OUT',
            value: 7200.00,
            source: 'Penalty For Delay',
            date: '2024-10-10'
        },
        {
            type: 'IN',
            value: 30500.00,
            source: 'Contract #590',
            date: '2024-11-21'
        },
        {
            type: 'OUT',
            value: 4500.00,
            source: 'Utilities',
            date: '2024-09-18'
        },
        {
            type: 'IN',
            value: 18900.00,
            source: 'Order #327',
            date: '2024-10-30'
        },
        {
            type: 'OUT',
            value: 5600.00,
            source: 'Cloud Expenses',
            date: '2024-11-08'
        },
        {
            type: 'IN',
            value: 23100.00,
            source: 'Contract #678',
            date: '2024-10-05'
        },
        {
            type: 'OUT',
            value: 19000.00,
            source: 'Office Rent',
            date: '2024-08-03'
        },
        {
            type: 'IN',
            value: 13250.00,
            source: 'Order #871',
            date: '2024-10-15'
        },
        {
            type: 'OUT',
            value: 7700.00,
            source: 'Reimbursement',
            date: '2024-12-01'
        },
        {
            type: 'IN',
            value: 21500.00,
            source: 'Contract #456',
            date: '2024-11-30'
        },
        {
            type: 'OUT',
            value: 54000.00,
            source: 'Payroll',
            date: '2024-12-04'
        },
        {
            type: 'IN',
            value: 17800.00,
            source: 'Order #451',
            date: '2024-11-11'
        },
        {
            type: 'OUT',
            value: 3400.00,
            source: 'Cloud Expenses',
            date: '2024-12-05'
        }
    ]
}


get_transactions = async () => {
    return await transaction_list()
}


const params = {
     toPay: {
        placeholder: 'charge-transactions-placeholder',
        pathToElement: 'charges-transactions-table.html',
        typeFilter: 'OUT',
        tableBodyElement: '.table-charges-transactions tbody',
        tableUpHeaderValuesResume : '.table-charges-transactions-footer td h2'
    },
    toReceive: {
        placeholder: 'income-transactions-placeholder',
        pathToElement: 'incomes-transactions-table.html',
        typeFilter: 'IN',
        tableBodyElement: '.table-transactions-incomes tbody',
        tableFooterTextElement : '.table-transactions-incomes-footer td h2'
    }
}


async function getFilteredTransactions() {
    const transactions = await get_transactions()
    
    const filteredInTransactions = transactions.filter(transaction => transaction.type === 'IN');
    
    const filteredOutTransactions = transactions.filter(transaction => transaction.type === 'OUT');
    
    return {
        'IN': filteredInTransactions,
        'OUT': filteredOutTransactions
    }
    
}


$(document).ready(async function () {
    // Carrega um arquivo HTML externo (charges-transactions-table.html)
    // dentro do elemento com o ID transactions-placeholder (index.html)
    const filteredTransactions = await getFilteredTransactions()
    
    $('#' + params.toPay.placeholder).load(params.toPay.pathToElement, function () {
        renderTransactionsInTableRows(
            filteredTransactions['OUT'],
            params.toPay.tableBodyElement,
            params.toPay.tableUpHeaderValuesResume,
            'OUT'
        );
    });
    
    $('#' + params.toReceive.placeholder).load(params.toReceive.pathToElement, function () {
        renderTransactionsInTableRows(
            filteredTransactions['IN'],
            params.toReceive.tableBodyElement,
            params.toReceive.tableFooterTextElement,
            'IN'
        );
    });
});

function renderTransactionsInTableRows(filteredTransactions, tableBodyElement, tableUpHeaderValuesResume, transaction_type) {
    let rowClassName  = "charge-transaction-row";
    if (transaction_type === 'IN') {
        rowClassName = "income-transaction-row"
    }
    
    const tableBody = $(tableBodyElement);
    
    tableBody.empty();
    let total = 0;
    filteredTransactions.forEach(transaction => {
        const row = `<tr class=${rowClassName}>
            <th scope="row">${transaction.date}</th>
            <td>${transaction.source}</td>
            <td class="transaction-value-column">$${transaction.value.toFixed(2)}</td>
        </tr>`;
        tableBody.append(row);
        total += transaction.value;
    });
    
    $(tableUpHeaderValuesResume).text(`$ ${total.toFixed(2)}`);
}
